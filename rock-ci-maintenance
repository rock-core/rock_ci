#! /bin/sh -ex
#
# Updates the infrastructure and packages for supported OSes

# Update the script itself
SCRIPT_URL=git://github.com/rock-core/rock_ci
cd "$ROCK_CI_DIR"
cur_id=$(git rev-parse HEAD)
git remote rm origin
git remote add -f origin "$SCRIPT_URL"
git remote update
git reset --hard origin/master
new_id=$(git rev-parse HEAD)
if test "x$cur_id" != "x$new_id"; then
    exec "$0" "$@"
fi

if which apt-get 2>&1; then
    sudo apt-get update
    sudo apt-get -y install wget ruby doxygen ruby1.9.1-dev
    sudo apt-get -y upgrade
fi

